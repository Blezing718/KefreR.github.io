---
layout: post
title: Twint
subtitle: Twint
tags: [test]
comments: true
mathjax: true
author: Frank Ressat
---
# Case study: Forensic analysis of the Swiss instant payment application Twint on iOS.

## Synopsis:

**Forensics Question:**  
This case study examines digital traces of money transactions generated by the usage of the Twint Prepaid application.

- **OS Version:**
  - iOS version 15.1.0
  - Twint Prepaid version 30.1.1

- **Tools:**  
  - UFED 4PC version 7.59.0.128
  - Cellebrite Physical Analyzer version 7.57.0.51
  - DB Browser version 3.12.2

### What is Twint?
Twint is an instant payment application available only in Switzerland. It is widely used across the country and allows quick monetary exchanges between users in Swiss Francs (CHF), as well as permitting payments via QR codes or Bluetooth Beacon stations.

There are several versions of the application depending on the userâ€™s bank, but a prepaid version, which is not linked to any bank, was chosen for this case study.

### Goal of the Study
The goal is to determine what kind of transaction data generated using Twint can be collected on iPhone 8 devices and what insights can be provided for digital forensic investigations. The study analyzes data stored on the device when various transactions are performed.

## Methodology
First, the prepaid version (30.1.1) of Twint was downloaded on an iPhone 8 test device (Model A1905, iOS version 15.1.0). The inductive reasoning approach was used to track procedures and maintain a chain of custody. Once the application was set up, various transactions were performed and documented with timestamps.

Data generated from these activities was then extracted using forensic tools:
- UFED 4PC (version 7.59.0.128) for the file system extraction using a checkm8 exploit.
- Cellebrite Physical Analyzer (version 7.57.0.51) and DB Browser (version 3.12.2) for data analysis.

#### Example of Activities

<img src="https://KefreR.github.io/assets/img/twint_transaction.png" alt="twint_transac" width="200"/>
![twint_transac](https://KefreR.github.io/assets/img/twint_transaction.png)
![twint_transac2](https://KefreR.github.io/assets/img/twint_transaction2.png)


(Figure 1: Examples of activities (transactions) performed)

### Forensic Extraction
A file system extraction was done using the checkm8 exploit. This allowed discovery of relevant folders and files for in-depth analysis. The GUID number of the Twint app was identified, and files were filtered using SQL queries to target Twint-related files. These files were then analyzed using a hex reader.

The analysis involved reviewing various data formats and matching the extracted data with documented activities, such as timestamps.

(Figure 2: Diagram of the methodology applied)

## Artifacts
A key file, `Twint.sqlite`, was discovered. The `ZTRANSACTION` table logs all transactions, and its columns were analyzed based on the established anchor points.

### Important Columns in `ZTRANSACTION` table:
- **ZCREATIONDATE**: Timestamp of transaction creation (Apple Absolute Time +1 format).
- **ZMODIFIEDTIMESTAMP**: Timestamp of transaction confirmation.
- **ZSECONDPHASETIMESTAMP**: Timestamp when the response was received by the receiving phone.
- **ZMERCHANTNAME**: Name of the merchant receiving the transaction (e.g., Kiosk, Coop).
- **ZP2PSENDERMOBILENR**: Phone number of the sender.
- **ZP2PINIATEMESSAGE**: Message sent during the transaction initiation.
- **ZP2PRECIPIENTMOBILENR**: Phone number of the transaction recipient.
- **ZP2PRECIPIENTNAME**: Name of the transaction recipient.
- **ZP2PREPLYMESSAGE**: Response message to the transaction initiation.
- **ZAUTHORIZEDAMOUNT**: Authorized amount for the transaction (NULL if rejected).
- **ZPAIDAMOUNT**: Paid amount (NULL for rejected transactions).
- **ZREQUESTEDAMOUNT**: Requested amount, even if rejected.
- **ZCURRENCY**: Currency used in the transaction.
- **ZCONTENTREFERENCE**: Reference to multimedia content (e.g., GIF).
- **ZORDERSTATEVALUE**: Status of the transaction (e.g., finalized, rejected, awaiting confirmation).
- **ZORDERTYPEVALUE**: Type of transaction (e.g., between individuals or organizations).
- **ZP2PHASPICTURE**: Indicates the presence of media in the transaction.
- **ZTRANSACTIONIDEVALUE**: Indicates if the transaction is a cash inflow or outflow.
- **ZMERCHANTCONFIRMATION**: Indicates if merchant confirmation is required.
- **ZMERCHANTTRANSACTIONREF**: Transaction number generated by an organization.
- **ZORDERUUIDSTRING**: Order ID generated by an organization.

(Figure 3: Content of `P2PRECIPIENTMOBILENR` column)  
(Figure 4: Content of `ZP2PRECIPIENTNAME` column)

### SQL Query to Extract Data:
```sql
SELECT
  ZTRANSACTION.Z_PK,
  datetime(ZTRANSACTION.ZCREATIONDATE + 978307200, 'UNIXEPOCH', 'LOCALTIME'),
  datetime(ZTRANSACTION.ZMODIFIEDTIMESTAMP + 978307200, 'UNIXEPOCH', 'LOCALTIME'),
  datetime(ZTRANSACTION.ZSECONDPHASETIMESTAMP + 978307200, 'UNIXEPOCH', 'LOCALTIME'),
  ZTRANSACTION.ZMERCHANTNAME,
  ZTRANSACTION.ZP2PSENDERMOBILENR,
  ZTRANSACTION.ZP2PINITIATEMESSAGE,
  ZTRANSACTION.ZP2PRECIPIENTMOBILENR,
  ZTRANSACTION.ZP2PRECIPIENTNAME,
  ZTRANSACTION.ZP2PREPLYMESSAGE,
  ZTRANSACTION.ZAUTHORIZEDAMOUNT,
  ZTRANSACTION.ZPAIDAMOUNT,
  ZTRANSACTION.ZREQUESTEDAMOUNT,
  ZTRANSACTION.ZCURRENCY,
  ZTRANSACTION.ZCONTENTREFERENCE,
  ZTRANSACTION.ZCONTENTREFERENCESOURCEVALUE,
  ZTRANSACTION.ZORDERSTATEVALUE,
  ZTRANSACTION.ZORDERTYPEVALUE,
  ZTRANSACTION.ZP2PHASPICTURE,
  ZTRANSACTION.ZTRANSACTIONSIDEVALUE,
  ZTRANSACTION.ZMERCHANTTRANSACTIONREF,
  ZTRANSACTION.ZORDERUUIDSTRING,
  ZTRANSACTION.ZMERCHANTCONFIRMATION
FROM ZTRANSACTION;
```
